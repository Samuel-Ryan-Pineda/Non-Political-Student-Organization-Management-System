{% extends 'user/userbase.html' %}

{% block title %}Organization Details{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/organizationdetails.css') }}?v={{ cache_version }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/organization.css') }}?v={{ cache_version }}">
<script src="{{ url_for('static', filename='js/manageorganization.js') }}?v={{ cache_version }}" defer></script>
<script src="{{ url_for('static', filename='js/user/modal/editOrganizationModal.js') }}?v={{ cache_version }}" defer></script>
<script src="{{ url_for('static', filename='js/user/modal/adviserInfoModal.js') }}?v={{ cache_version }}" defer></script>
<script src="{{ url_for('static', filename='js/user/modal/socialMediaModal.js') }}?v={{ cache_version }}" defer></script>
<style>
  table th:nth-last-child(1),
  table td:nth-last-child(1) {
    text-align: center;
  }

  .organization-header {
    position: relative;
  }
  
  /* New Edit Organization Modal Styles */
  .container-short {
    margin: 0 auto;
  }
  
  .rounded-2xl {
    border-radius: 1rem;
  }
  
  .text-gray-500 {
    color: #6b7280;
  }
  
  .text-gray-900 {
    color: #111827;
  }
  
  .border-gray-100 {
    border-color: #f3f4f6;
  }
  
  /* Optimize textarea height handling with CSS */
  textarea.field-display {
    overflow: hidden;
    min-height: 0.8rem;
    height: auto;
    box-sizing: border-box;
    width: 100%;
    transition: height 0.1s ease-in-out;
  }
  
  /* Ensure field containers have proper sizing */
  .field-container {
    width: 100%;
    position: relative;
  }
  
  .btn-upload {
    background-color: var(--button-color);
    color: white;
    border: none;
    border-radius: 0.375rem;
    padding: 0.5rem 1rem;
    font-size: 0.8rem;
    cursor: pointer;
  }
  
  .btn-upload:hover {
    background-color: var(--button-hover);
  }
  
  .btn-edit {
    background-color: transparent;
    color: #6b7280;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    cursor: pointer;
  }
  
  .btn-edit:hover {
    background-color: #f3f4f6;
  }
</style>
{% endblock %}

{% block additional_content %}
    <!-- Hidden organization ID field for JavaScript use -->
    <input type="hidden" id="organization-id" value="{{ organization.organization_id }}">
    
    <section class="organization-header">
        <div class="d-flex justify-content-center align-items-center">
            <div class="d-flex flex-column flex-sm-row gap-5 align-items-center justify-content-center">
                {% if organization.logo_id %}
                <img src="{{ url_for('user_organization.get_logo', logo_id=organization.logo_id) }}" alt="{{ organization.organization_name }} logo" title="{% if organization.logo.description %}{{ organization.logo.description }}{% else %}{{ organization.organization_name }} - {{ organization.type if organization.type else 'Organization' }} Logo{% endif %}" class="org-logo">
                {% else %}
                <img src="https://placehold.co/120x120/png/ffffff/000000?text=Logo" alt="Organization logo" title="Organization Logo - Click Edit Organization to upload a custom logo" class="org-logo">
                {% endif %}
                <div class="flex-grow-1 text-start">
                    <h2 class="org-title">{{ organization.organization_name }}</h2>
                    {% if organization.type %}
                    <p class="org-type"><strong>Type:</strong> {{ organization.type }}</p>
                    {% endif %}
                    {% if organization.tagline %}
                    <p class="org-quote">"{{ organization.tagline }}"</p>
                    {% endif %}
                    {% if organization.description %}
                    <p class="org-description">{{ organization.description }}</p>
                    {% endif %}
                    {% if adviser %}
                    <p class="org-adviser">{{ adviser.type if adviser.type else 'Adviser' }}: {{ adviser.full_name }}</p>
                    {% endif %}
                    {% if social_media %}
                    <p class="org-social">
                        <strong>Social Media:</strong><br>
                        {% for sm in social_media %}
                        {{ sm.platform }}: {{ sm.link }}<br>
                        {% endfor %}
                    </p>
                    {% endif %}
                    
                    <!-- Organization Management Buttons -->
                    <div class="mt-3 align-self-right">
                        <button type="button" class="btn btn-primary me-2 mb-2" style="font-size: 0.8rem;" onclick="showEditOrganizationProfileModal()">
                            Edit Organization
                        </button>
                        <button type="button" class="btn btn-secondary me-2 mb-2" style="font-size: 0.8rem;" onclick="showAdviserInfoModal()">
                            Adviser Info
                        </button>
                        <i class="fas fa-link" style="font-size: 1.2rem; color: white; cursor: pointer;" onclick="showSocialMediaModal()" title="Social Media Links"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block content %}
<div class="container">
    <section class="stats-container">
        {% set stats = [
            {'class': 'stat-members', 'label': 'No. of Members', 'icon': 'fas fa-users', 'value': '35'},
            {'class': 'stat-volunteers', 'label': 'No. of Volunteers', 'icon': 'fas fa-hand-holding-heart', 'value': '13'},
            {'class': 'stat-activities', 'label': 'Accomplished Activities', 'icon': 'fas fa-tasks', 'value': '2'}
        ] %}
        
        {% for stat in stats %}
        <div class="stat-card {{ stat.class }}">
            <div>{{ stat.label }}</div>
            <div class="d-flex align-items-center fw-semibold fs-4">
                <i class="{{ stat.icon }} stat-icon"></i> {{ stat.value }}
            </div>
        </div>
        {% endfor %}
        
        <div class="stat-card stat-status">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                Organization Status
                <span class="status-active">Active</span>
            </div>
        </div>
    </section>

    <section class="table-container">
        <h3 class="table-title">Board of Officers</h3>
        <div class="table-scroll">
            <table>
                <thead>
                    <tr>
                        <th style="width:12%;">Position</th>
                        <th style="width:13%;">Student No.</th>
                        <th style="width:25%;">Name</th>
                        <th style="width:10%;">Program</th>
                        <th style="width:25%;">Address</th>
                        <th style="width:15%;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% set officers = [
                    {'position': 'President', 'student_no': 'SUM2022-00001', 'name': 'Juan Miguel Dela Cruz', 'program': 'BSIT', 'address': 'Cabanatuan City, Nueva Ecija'},
                    {'position': 'Vice President', 'student_no': 'SUM2022-00002', 'name': 'Maria Elena Santos', 'program': 'BSIT', 'address': 'Gapan City, Nueva Ecija'},
                    {'position': 'Secretary', 'student_no': 'SUM2022-00003', 'name': 'Angelo Martin Reyes', 'program': 'BSIT', 'address': 'Cabanatuan City, Nueva Ecija'},
                    {'position': 'Treasurer', 'student_no': 'SUM2022-00004', 'name': 'Bianca Rose Mendoza', 'program': 'BSIT', 'address': 'Cabanatuan City, Nueva Ecija'},
                    {'position': 'Public Relations Officer', 'student_no': 'SUM2022-00005', 'name': 'Jasmine Mae Lim', 'program': 'BSIT', 'address': 'Palayan City, Nueva Ecija'},
                    {'position': 'Treasurer', 'student_no': 'SUM2022-00006', 'name': 'Miguel Antonio Tan', 'program': 'BSIT', 'address': 'Talavera, Nueva Ecija'},
                    {'position': 'Events Coordinator', 'student_no': 'SUM2022-00007', 'name': 'Sofia Marie Garcia', 'program': 'BSIT', 'address': 'Cabanatuan City, Nueva Ecija'},
                    {'position': 'Technical Lead', 'student_no': 'SUM2022-00008', 'name': 'Diego Rafael Bautista', 'program': 'BSIT', 'address': 'Gapan City, Nueva Ecija'},
                    {'position': 'Membership Coordinator', 'student_no': 'SUM2022-00009', 'name': 'Isabella Marie Lopez', 'program': 'BSIT', 'address': 'Cabanatuan City, Nueva Ecija'}
                    ] %}
                    
                    {% for officer in officers %}
                    <tr>
                        <td>{{ officer.position }}</td>
                        <td>{{ officer.student_no }}</td>
                        <td>{{ officer.name }}</td>
                        <td>{{ officer.program }}</td>
                        <td>{{ officer.address }}</td>
                        <td>
                            <button type="button" class="btn btn-primary btn-sm" onclick="showEditOfficerModal('{{ officer.position }}', '{{ officer.student_no }}', '{{ officer.name }}', '{{ officer.program }}', '{{ officer.address }}')">
                                <i class="fas fa-edit"></i> Update
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="d-flex justify-content-end mb-2 mt-3">
            <button type="button" class="btn btn-primary" style="background-color: #0D3B44;" onclick="showOfficerModal()">
                <i class="fas fa-plus"></i> Add Officer
            </button>
        </div>
    </section>

    <section class="row g-4 mb-1">
        {% set people_tables = [
            {'title': 'Members', 'id': 'members'},
            {'title': 'Volunteer', 'id': 'volunteers'}
        ] %}
        
        {% for table in people_tables %}
        <div class="col-12 col-md-6">
            <section class="table-container">
                <h3 class="table-title">{{ table.title }}</h3>
                <div class="table-scroll">
                    <table>
                        <thead>
                            <tr>
                                <th style="width:8%;">No.</th>
                                <th style="width:20%;">Student No.</th>
                                <th style="width:27%;">Name</th>
                                <th style="width:20%;">Program</th>
                                <th style="width:25%;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set members = [
                            {'no': '1', 'student_no': 'SUM2022-00001', 'name': 'Miguel Santos Sanchez', 'program': 'BSIT'},
                            {'no': '2', 'student_no': 'SUM2022-00002', 'name': 'Sophia Marie Chen', 'program': 'BSIT'},
                            {'no': '3', 'student_no': 'SUM2022-00003', 'name': 'Amir Hassan Khan', 'program': 'BSIT'},
                            {'no': '4', 'student_no': 'SUM2022-00004', 'name': 'Isabella Maria Rodríguez', 'program': 'BSIT'},
                            {'no': '5', 'student_no': 'SUM2022-00005', 'name': 'Liam Patrick O\'Connor', 'program': 'BSIT'},
                            {'no': '6', 'student_no': 'SUM2022-00006', 'name': 'Priya Raj Patel', 'program': 'BSIT'},
                            {'no': '7', 'student_no': 'SUM2022-00007', 'name': 'Mateo Luis Fernandez', 'program': 'BSIT'},
                            {'no': '8', 'student_no': 'SUM2022-00008', 'name': 'Zoe Elizabeth Williams', 'program': 'BSIT'},
                            {'no': '9', 'student_no': 'SUM2022-00009', 'name': 'Jamal Andre Washington', 'program': 'BSIT'},
                            {'no': '10', 'student_no': 'SUM2022-00010', 'name': 'Mei Ling Zhang', 'program': 'BSIT'}
                            ] %}

                            {% for member in members %}
                            <tr>
                                <td>{{ member.no }}</td>
                                <td>{{ member.student_no }}</td>
                                <td>{{ member.name }}</td>
                                <td>{{ member.program }}</td>
                                <td>
                                    <button type="button" class="btn btn-primary btn-sm" onclick="showEditMemberModal('{{ member.student_no }}', '{{ member.name }}', '{{ member.program }}')">
                                        <i class="fas fa-edit"></i> Update
                                    </button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="pagination-controls">
                    <button type="button"><i class="fas fa-chevron-left"></i> Previous</button>
                    <button type="button">Next <i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="d-flex justify-content-end mb-2 mt-3">
                    <button type="button" class="btn btn-primary" style="background-color: #0D3B44;" onclick="show{{ table.title }}Modal()">
                        <i class="fas fa-plus"></i> Add {{ table.title }}
                    </button>
                </div>
            </section>
        </div>
        {% endfor %}
    </section>

    <section class="table-container">
    <h3 class="table-title">Plans</h3>
    <div class="table-scroll">
        <table>
        <thead>
            <tr>
            <th style="width:4%;">No.</th>
            <th style="width:18%;">Programs/Projects/Activities</th>
            <th style="width:23%;">Objectives</th>
            <th style="width:10%;">Proposed Date</th>
            <th style="width:13%;">People Involved</th>
            <th style="width:10%;">Source of Funds</th>
            <th style="width:10%;">Venue</th>
            <th style="width:7%;">Outcome</th>
            <th style="width:5%;">Action</th>
            </tr>
        </thead>
        <tbody>
            {% set plans = [
            {
                'no': '1',
                'title': 'Alay sa First Year',
                'objectives': 'Support the competitors in different contests in the event. To disseminate SSITE objectives through booth pitching',
                'date': 'August 05, 2023',
                'people': 'SSITE Officers and Members',
                'funds': 'SSITE Funds<br><small>(if necessary)</small>',
                'venue': 'NEUST Close Gym',
                'outcome': 'Successful'
            },
            {
                'no': '2',
                'title': 'Midterm Exam 2023 motivational support to CICT Students',
                'objectives': 'Provide members support for their review and preparation for the term examinations.',
                'date': 'October 13, 2023',
                'people': 'SSITE Officers',
                'funds': 'SSITE Funds<br><small>(if necessary)</small>',
                'venue': 'CICT Department',
                'outcome': 'Successful'
            }
            ] %}
            
            {% for plan in plans %}
            <tr>
            <td>{{ plan.no }}</td>
            <td>{{ plan.title }}</td>
            <td>{{ plan.objectives }}</td>
            <td>{{ plan.date }}</td>
            <td>{{ plan.people }}</td>
            <td>{{ plan.funds|safe }}</td>
            <td>{{ plan.venue }}</td>
            <td class="outcome-successful">{{ plan.outcome }}</td>
            <td>
                <button type="button" class="btn btn-primary btn-sm" onclick="showEditPlanModal('{{ plan.no }}', '{{ plan.title }}', '{{ plan.objectives }}', '{{ plan.date }}', '{{ plan.people }}', '{{ plan.funds }}', '{{ plan.venue }}', '{{ plan.outcome }}')">
                    <i class="fas fa-edit"></i> Update
                </button>
            </td>
            </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
    <div class="d-flex justify-content-end mb-2 mt-3">
        <button type="button" class="btn btn-primary" style="background-color: #0D3B44;" onclick="showAddPlanModal()">
            <i class="fas fa-plus"></i> Add Plan
        </button>
    </div>
    </section>
</div>


<!-- Include Organization Profile Editor -->
{% include 'user/modal/editOrganizationModal.html' %}
{% include 'user/modal/adviserInfoModal.html' %}
{% include 'user/modal/socialmedialinks.html' %}
{% endblock %}